<template>
  <lightning-card title="Opportunity Pipeline" icon-name="standard:opportunity">
      <div class="slds-p-horizontal_small">
          <div class="slds-grid slds-wrap">
              <!-- Iterate over stages with opportunities -->
              <template for:each={stagesWithOpportunities} for:item="stageObj">
                  <div key={stageObj.name} class="slds-col slds-size_1-of-1 slds-medium-size_1-of-3 slds-large-size_1-of-6">
                      <div class="slds-box slds-box_x-small slds-m-top_small slds-p-around_medium stage-droppable"
                           ondragover={handleDragOver}
                           ondrop={handleDrop}
                           data-stage={stageObj.name}>
                          <h3 class="slds-text-heading_small">{stageObj.name}</h3>
                          <!-- Display opportunities in this stage -->
                          <template for:each={stageObj.opportunities} for:item="opp">
                              <div key={opp.Id}
                                   class="slds-box slds-box_x-small slds-text-align_center slds-m-bottom_small opportunity-draggable"
                                   draggable="true"
                                   ondragstart={handleDragStart}
                                   data-id={opp.Id}>
                                  {opp.Name}
                              </div>
                          </template>
                      </div>
                  </div>
              </template>
          </div>
      </div>
  </lightning-card>
</template>
